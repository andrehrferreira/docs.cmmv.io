# Serialization

Serialization and deserialization in a project using ``class-transformer`` are crucial for converting JavaScript objects into specific class instances and vice versa. In the example above, the ``Task`` class, automatically generated by ``@cmmv/core``, can be serialized and validated, ensuring the application processes data safely and with correct typing.

The goal of serialization is to transform data into appropriate class instances, ensuring the objects being manipulated have the correct properties and types. We use the ``class-transformer`` package for serializing and deserializing objects and ``class-validator`` to validate the data.

Here’s an implementation of a ``Task`` model that represents a task and uses ``class-validator`` and ``class-transformer`` to ensure proper serialization and validation of fields:

```typescript
// Generated automatically by CMMV

import { IsString, IsNotEmpty, IsBoolean } from 'class-validator';
import { plainToClass, classToPlain } from 'class-transformer';

export interface ITask {
    id?: any;
    label: string;
    checked: boolean;
    removed: boolean;
}

export class Task implements ITask {
    id?: any;

    @IsString({ message: 'Invalid label' })
    @IsNotEmpty({ message: 'Invalid label' })
    label: string;

    @IsBoolean({ message: 'Invalid checked type' })
    checked: boolean = false;

    @IsBoolean({ message: 'Invalid removed type' })
    removed: boolean = false;

    constructor(partial: Partial<Task>) {
        Object.assign(this, partial);
    }
}
```

<br/>

* **``plainToInstance:``** Converts plain objects (like JSON) into class instances, transforming a received JSON object into an instance of the ``Task`` class.
* **``instanceToPlain:``** Converts a class instance back into a plain object for serialization or sending in an HTTP response.

Here’s how we convert a plain object representing a task into an instance of the ``Task`` class using ``plainToInstance``:

## Deserializing

```typescript
import { plainToInstance } from 'class-transformer';

// Plain object
const plainTask = {
    label: 'Complete report',
    checked: true,
    removed: false,
};

// Convert to a Task class instance
const taskInstance = plainToInstance(Task, plainTask);

console.log(taskInstance); // Instance of Task
```

## Serializing 

When the application needs to send data to a database or an API, it can serialize the class instance back into a plain object using ``instanceToPlain``.

```typescript
import { instanceToPlain } from 'class-transformer';

const taskInstance = new Task({ label: 'Complete report', checked: true });

// Convert to a plain object
const plainTask = instanceToPlain(taskInstance);

console.log(plainTask); // Plain object
```

## Data Validation

Use validate from ``class-validator`` to check if the data is valid:

```typescript
import { validate } from 'class-validator';

const taskInstance = new Task({ label: '', checked: 'true' });

validate(taskInstance).then(errors => {
    if (errors.length > 0) {
        console.log('Validation failed. Errors: ', errors);
    } else {
        console.log('Validation succeeded');
    }
});
```

By using ``class-transformer`` and ``class-validator``, you ensure that class instances are properly validated and easily converted between plain objects and class instances. This provides a strong validation layer and simplifies data handling, especially for APIs and databases.