<h1>CLI</h1><a id="cli" title="CLI"></a>
<p>The CMMV CLI simplifies project initialization by providing an interactive way to create a new project with customizable configurations. Below is the updated documentation for using the CLI to generate a CMMV project.</p>
<h2>Getting Started</h2><a id="getting-started" title="Getting Started"></a>
<p>Install the CLI Globally: To use the CLI globally on your system, install it using <code>pnpm</code>:</p>
<div class="code-block-container">
                <button class="copy-code-btn" onclick="copyToClipboard(this)" title="Copy">
                    <i class="fa-regular fa-clone"></i>
                </button>
                <pre><code class="hljs language-bash" lang="bash"">$ pnpm add -g @cmmv/cli
</code></pre>
             </div>
<p>Create a New Project: Run the <code>cmmv create</code> command to create a new project:</p>
<div class="code-block-container">
                <button class="copy-code-btn" onclick="copyToClipboard(this)" title="Copy">
                    <i class="fa-regular fa-clone"></i>
                </button>
                <pre><code class="hljs language-bash" lang="bash"">$ cmmv create &lt;project-name&gt;
</code></pre>
             </div>
<p>This will start an interactive prompt asking for your project preferences, such as:</p>
<ul>
<li>Whether to enable Vite Middleware</li>
<li>Use RPC (WebSocket)</li>
<li>Enable the Cache module</li>
<li>Select the repository type (SQLite, MongoDB, PostgreSQL, MySQL)</li>
<li>Choose the View configuration (Reactivity, Vue3, or Vue3 + TailwindCSS)</li>
<li>Enable ESLint, Prettier, and Vitest</li>
</ul>
<h2>Using <code>pnpm dlx</code></h2><a id="using-pnpm-dlx" title="Using pnpm dlx"></a>
<p>If you don’t want to install the CLI globally, use <code>pnpm dlx</code> to execute it directly:</p>
<div class="code-block-container">
                <button class="copy-code-btn" onclick="copyToClipboard(this)" title="Copy">
                    <i class="fa-regular fa-clone"></i>
                </button>
                <pre><code class="hljs language-bash" lang="bash"">$ pnpm dlx @cmmv/cli@latest create &lt;project-name&gt;
</code></pre>
             </div>
<p>This ensures you always use the latest version of the CLI without requiring a global installation.</p>
<h2>Generated Project Structure</h2><a id="generated-project-structure" title="Generated Project Structure"></a>
<p>The CLI generates a structured project folder with necessary files and directories based on your preferences. Below is an example structure:</p>
<div class="code-block-container">
                <button class="copy-code-btn" onclick="copyToClipboard(this)" title="Copy">
                    <i class="fa-regular fa-clone"></i>
                </button>
                <pre><code class="hljs"">.
├── public/
│   ├── assets/
│   │   └── protobuf.min.js (if RPC is enabled)
│   ├── core/
│   ├── templates/
│   └── views/
├── src/
│   ├── contracts/
│   ├── controllers/
│   ├── entities/
│   ├── models/
│   ├── modules/
│   ├── services/
│   ├── locale/
│   ├── app.module.ts
│   ├── server.ts
│   └── client.ts (if Vite is enabled)
├── node_modules/
├── index.html (if Vite is enabled)
├── tailwind.config.js (if TailwindCSS is enabled)
├── tsconfig.json
├── tsconfig.client.json (if Vite is enabled)
├── tsconfig.vue.json (if Vue3 or Vue3 + TailwindCSS is enabled)
├── vite.config.js (if Vite is enabled)
├── vitest.config.ts (if Vitest is enabled)
├── .cmmv.config.js
├── package.json
├── .gitignore
└── ...
</code></pre>
             </div>
<p><strong>Generated Configuration Files</strong></p>
<ul>
<li><code>.cmmv.config.js</code>: Central configuration for the CMMV application.</li>
<li><code>package.json</code>: Includes necessary dependencies and scripts based on your selected options.</li>
<li><code>tsconfig.json</code>: References for TypeScript configurations.</li>
<li><code>.gitignore</code>, <code>.npmignore</code>, <code>.prettierignore</code>, <code>.prettierrc</code>, <code>.swcrc</code>: Pre-configured files for development standards.</li>
<li><code>vite.config.js</code>: Vite configuration (if enabled).</li>
<li><code>tailwind.config.js</code> and <code>src/tailwind.css</code>: TailwindCSS configuration (if enabled).</li>
</ul>
<h2>Available Scripts</h2><a id="available-scripts" title="Available Scripts"></a>
<p>Development Mode:</p>
<div class="code-block-container">
                <button class="copy-code-btn" onclick="copyToClipboard(this)" title="Copy">
                    <i class="fa-regular fa-clone"></i>
                </button>
                <pre><code class="hljs language-bash" lang="bash"">$ pnpm dev
</code></pre>
             </div>
<p>Build for Production:</p>
<div class="code-block-container">
                <button class="copy-code-btn" onclick="copyToClipboard(this)" title="Copy">
                    <i class="fa-regular fa-clone"></i>
                </button>
                <pre><code class="hljs language-bash" lang="bash"">$ pnpm build
</code></pre>
             </div>
<p>Start Production Server:</p>
<div class="code-block-container">
                <button class="copy-code-btn" onclick="copyToClipboard(this)" title="Copy">
                    <i class="fa-regular fa-clone"></i>
                </button>
                <pre><code class="hljs language-bash" lang="bash"">$ pnpm start
</code></pre>
             </div>
<p>Run Tests (if Vitest is enabled):</p>
<div class="code-block-container">
                <button class="copy-code-btn" onclick="copyToClipboard(this)" title="Copy">
                    <i class="fa-regular fa-clone"></i>
                </button>
                <pre><code class="hljs language-bash" lang="bash"">$ pnpm <span class="hljs-built_in">test</span>
</code></pre>
             </div>
<h2>Module</h2><a id="module" title="Module"></a>
<p>The CMMV CLI now includes a <code>module</code> command to simplify the creation of new modules within an existing CMMV project. Modules help organize your application into reusable and feature-specific units. Below is the documentation for the <code>module</code> command.</p>
<div class="code-block-container">
                <button class="copy-code-btn" onclick="copyToClipboard(this)" title="Copy">
                    <i class="fa-regular fa-clone"></i>
                </button>
                <pre><code class="hljs language-bash" lang="bash"">$ cmmv module &lt;module-name&gt;
</code></pre>
             </div>
<h2>Generated Module Structure</h2><a id="generated-module-structure" title="Generated Module Structure"></a>
<div class="code-block-container">
                <button class="copy-code-btn" onclick="copyToClipboard(this)" title="Copy">
                    <i class="fa-regular fa-clone"></i>
                </button>
                <pre><code class="hljs language-bash" lang="bash"">module/
├── src/
│   ├── index.ts                <span class="hljs-comment"># Main entry point for the module</span>
├── scripts/
│   └── release.js (<span class="hljs-keyword">if</span> release is enabled)
├── tests/
│   └── index.test.ts (<span class="hljs-keyword">if</span> vitest is enabled)
├── .gitignore
├── .npmignore
├── .swcrc
├── tsconfig.json
├── tsconfig.cjs.json
├── tsconfig.esm.json
├── package.json
└── ...
</code></pre>
             </div>
<p>The generated package.json includes essential metadata and scripts for the module:</p>
<div class="code-block-container">
                <button class="copy-code-btn" onclick="copyToClipboard(this)" title="Copy">
                    <i class="fa-regular fa-clone"></i>
                </button>
                <pre><code class="hljs language-json" lang="json""><span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;module&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;version&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;0.0.1&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;description&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;keywords&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;author&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;publishConfig&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">&quot;access&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;public&quot;</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;engines&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">&quot;node&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&gt;=18.18.0 || &gt;=20.0.0&quot;</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;scripts&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">&quot;build:cjs&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;tsc --project tsconfig.cjs.json&quot;</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">&quot;build:esm&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;tsc --project tsconfig.esm.json&quot;</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">&quot;build&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;npm run build:cjs &amp;&amp; npm run build:esm&quot;</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">&quot;test&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;vitest&quot;</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">&quot;prepare&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;husky install&quot;</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">&quot;lint&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;pnpm run lint:spec&quot;</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">&quot;lint:fix&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;pnpm run lint:spec -- --fix&quot;</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">&quot;release&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;node scripts/release.js&quot;</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">&quot;changelog&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;conventional-changelog -p angular -i CHANGELOG.md -s&quot;</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;devDependencies&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        ...
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;dependencies&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">&quot;@cmmv/core&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^1.0.0&quot;</span>
    <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
             </div>
<h2>Contract</h2><a id="contract" title="Contract"></a>
<p>The <code>cmmv contract</code> command allows you to create contracts in the CMMV framework. Contracts define the structure, validation, and metadata for your application’s entities and controllers. Below is the documentation for using the <code>contract</code> command.</p>
<h3>Usage</h3>
<p>To create a contract, use the following command:</p>
<div class="code-block-container">
                <button class="copy-code-btn" onclick="copyToClipboard(this)" title="Copy">
                    <i class="fa-regular fa-clone"></i>
                </button>
                <pre><code class="hljs language-bash" lang="bash"">$ cmmv contract &lt;contract-name&gt;
</code></pre>
             </div>
<p>This will launch an interactive prompt to configure your contract. You can define the contract’s name, metadata, fields, and validation rules.</p>
<h3>Interactive Prompts</h3>
<p>The CLI will prompt you for the following details:</p>
<ul>
<li><strong>Contract Metadata:</strong> Configurations such as controller name, proto path, proto package, caching, and imports.</li>
<li><strong>Fields:</strong> Add fields to the contract with properties like proto type, default value, validations, and more.</li>
</ul>
<h3>Contract Structure</h3>
<p>Once the contract is created, it will be added to the src/contracts directory with the following structure:</p>
<div class="code-block-container">
                <button class="copy-code-btn" onclick="copyToClipboard(this)" title="Copy">
                    <i class="fa-regular fa-clone"></i>
                </button>
                <pre><code class="hljs language-bash" lang="bash"">src/contracts/
├── &lt;contract-name&gt;.contract.ts
</code></pre>
             </div>
<h3>Example</h3>
<div class="code-block-container">
                <button class="copy-code-btn" onclick="copyToClipboard(this)" title="Copy">
                    <i class="fa-regular fa-clone"></i>
                </button>
                <pre><code class="hljs language-typescript" lang="typescript""><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AbstractContract</span>, <span class="hljs-title class_">Contract</span>, <span class="hljs-title class_">ContractField</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@cmmv/core&#x27;</span>;

<span class="hljs-meta">@Contract</span>({
    <span class="hljs-attr">controllerName</span>: <span class="hljs-string">&#x27;Task&#x27;</span>,
    <span class="hljs-attr">protoPath</span>: <span class="hljs-string">&#x27;src/protos/task.proto&#x27;</span>,
    <span class="hljs-attr">protoPackage</span>: <span class="hljs-string">&#x27;task&#x27;</span>,
    <span class="hljs-attr">imports</span>: [<span class="hljs-string">&#x27;crypto&#x27;</span>],
    <span class="hljs-attr">cache</span>: {
        <span class="hljs-attr">key</span>: <span class="hljs-string">&#x27;task:&#x27;</span>,
        <span class="hljs-attr">ttl</span>: <span class="hljs-number">300</span>,
        <span class="hljs-attr">compress</span>: <span class="hljs-literal">true</span>,
    },
})
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TasksContract</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">AbstractContract</span> {
    <span class="hljs-meta">@ContractField</span>({
        <span class="hljs-attr">protoType</span>: <span class="hljs-string">&#x27;string&#x27;</span>,
        <span class="hljs-attr">unique</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-attr">validations</span>: [
            {
                <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;IsString&#x27;</span>,
                <span class="hljs-attr">message</span>: <span class="hljs-string">&#x27;Invalid label&#x27;</span>,
            },
            {
                <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;IsNotEmpty&#x27;</span>,
                <span class="hljs-attr">message</span>: <span class="hljs-string">&#x27;Invalid label&#x27;</span>,
            },
        ],
    })
    <span class="hljs-attr">label</span>: <span class="hljs-built_in">string</span>;

    <span class="hljs-meta">@ContractField</span>({
        <span class="hljs-attr">protoType</span>: <span class="hljs-string">&#x27;bool&#x27;</span>,
        <span class="hljs-attr">defaultValue</span>: <span class="hljs-literal">false</span>,
        <span class="hljs-attr">validations</span>: [
            {
                <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;IsBoolean&#x27;</span>,
                <span class="hljs-attr">message</span>: <span class="hljs-string">&#x27;Invalid checked type&#x27;</span>,
            },
        ],
    })
    <span class="hljs-attr">checked</span>: <span class="hljs-built_in">boolean</span>;

    <span class="hljs-meta">@ContractField</span>({
        <span class="hljs-attr">protoType</span>: <span class="hljs-string">&#x27;bool&#x27;</span>,
        <span class="hljs-attr">defaultValue</span>: <span class="hljs-literal">false</span>,
        <span class="hljs-attr">validations</span>: [
            {
                <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;IsBoolean&#x27;</span>,
                <span class="hljs-attr">message</span>: <span class="hljs-string">&#x27;Invalid removed type&#x27;</span>,
            },
        ],
    })
    <span class="hljs-attr">removed</span>: <span class="hljs-built_in">boolean</span>;

    <span class="hljs-meta">@ContractField</span>({ <span class="hljs-attr">protoType</span>: <span class="hljs-string">&#x27;date&#x27;</span> })
    createdAt?: <span class="hljs-title class_">Date</span>;
}
</code></pre>
             </div>
<h3>Integration</h3>
<p>To integrate a contract into your application, you need to register it in the <code>Application</code> setup within your <code>index.ts</code> or <code>server.ts</code> or entry point file. This ensures the contract is available for use in your application.</p>
<p>Include the contract in the contracts property of the Application.create configuration. Here’s an example:</p>
<div class="code-block-container">
                <button class="copy-code-btn" onclick="copyToClipboard(this)" title="Copy">
                    <i class="fa-regular fa-clone"></i>
                </button>
                <pre><code class="hljs language-typescript" lang="typescript""><span class="hljs-comment">// Imports</span>

<span class="hljs-keyword">import</span> { <span class="hljs-title class_">TasksContract</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./contracts/tasks.contract&#x27;</span>; <span class="hljs-comment">// Register your import here</span>

<span class="hljs-comment">// Create the application</span>
<span class="hljs-title class_">Application</span>.<span class="hljs-title function_">create</span>({
    <span class="hljs-attr">httpAdapter</span>: <span class="hljs-title class_">DefaultAdapter</span>,
    <span class="hljs-attr">wsAdapter</span>: <span class="hljs-title class_">WSAdapter</span>,
    <span class="hljs-attr">modules</span>: [
        ...
    ],
    <span class="hljs-attr">services</span>: [...],
    <span class="hljs-attr">transpilers</span>: [...],
    <span class="hljs-attr">contracts</span>: [<span class="hljs-title class_">TasksContract</span>], <span class="hljs-comment">// Register your contract here</span>
});
</code></pre>
             </div>
