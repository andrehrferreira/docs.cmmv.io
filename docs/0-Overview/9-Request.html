<h1>Request</h1><a id="request" title="Request"></a>
<p>The <code>HttpService</code> class in the <code>@cmmv/http</code> package provides a convenient way to make HTTP requests to external APIs using the <code>Axios</code> <a href="https://www.npmjs.com/package/axios" target="_blank" rel="nofollow">NPM</a> library. It extends the <code>AbstractService</code> and is registered as a service with the name <code>'http'</code>. The service wraps common HTTP request methods such as <code>GET</code>, <code>POST</code>, <code>DELETE</code>, <code>PUT</code>, <code>PATCH</code>, and <code>HEAD</code> while using Axios for handling requests and responses.</p>
<p>To use the <code>HttpService</code> in your project, make sure to import it from the <code>@cmmv/http</code> package:</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">HttpService</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@cmmv/http&#x27;</span>;
</code></pre>
<p>The <code>HttpService</code> provides several HTTP methods for interacting with external APIs. These methods support custom configurations through <code>AxiosRequestConfig</code> and return a <code>Promise</code> that resolves with an <code>AxiosResponse</code>.</p>
<h2>Methods</h2><a id="methods" title="Methods"></a>
<p><code>request&lt;T&gt;(config: AxiosRequestConfig): Promise&lt;AxiosResponse&lt;T&gt;&gt;</code></p>
<ul>
<li><strong>Description:</strong> Performs a generic HTTP request based on the given Axios configuration.</li>
</ul>
<p><strong>Parameters:</strong></p>
<ul>
<li>
<p><strong><code>config:</code></strong> An AxiosRequestConfig object that defines the HTTP method, headers, and other request configurations.</p>
</li>
<li>
<p><strong>Returns:</strong> A Promise that resolves with an AxiosResponse.</p>
</li>
</ul>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">httpService</span>.<span class="hljs-title function_">request</span>({
    <span class="hljs-attr">method</span>: <span class="hljs-string">&#x27;GET&#x27;</span>,
    <span class="hljs-attr">url</span>: <span class="hljs-string">&#x27;https://api.example.com/data&#x27;</span>,
});
</code></pre>
<h2>Get</h2><a id="get" title="Get"></a>
<p><code>get&lt;T&gt;(url: string, config?: AxiosRequestConfig): Promise&lt;AxiosResponse&lt;T&gt;&gt;</code></p>
<ul>
<li><strong>Description:</strong> Sends an HTTP <code>GET</code> request to the specified URL.</li>
</ul>
<p><strong>Parameters:</strong></p>
<ul>
<li>
<p><strong><code>url:</code></strong> The URL to send the GET request to.</p>
</li>
<li>
<p><strong><code>config:</code></strong> An AxiosRequestConfig object that defines the HTTP method, headers, and other request configurations.</p>
</li>
<li>
<p><strong>Returns:</strong> A Promise that resolves with an AxiosResponse.</p>
</li>
</ul>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">httpService</span>.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;https://api.example.com/data&#x27;</span>);
</code></pre>
<h2>Delete</h2><a id="delete" title="Delete"></a><a id="delete" title="Delete"></a>
<p><code>delete&lt;T&gt;(url: string, config?: AxiosRequestConfig): Promise&lt;AxiosResponse&lt;T&gt;&gt;</code></p>
<ul>
<li><strong>Description:</strong> Sends an HTTP <code>DELETE</code> request to the specified URL.</li>
</ul>
<p><strong>Parameters:</strong></p>
<ul>
<li>
<p><strong><code>url:</code></strong> The URL to send the DELETE request to.</p>
</li>
<li>
<p><strong><code>config:</code></strong> Optional Axios configuration options.</p>
</li>
<li>
<p><strong>Returns:</strong> A Promise that resolves with an AxiosResponse.</p>
</li>
</ul>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> httpService.<span class="hljs-title function_">delete</span>(<span class="hljs-string">&#x27;https://api.example.com/data/1&#x27;</span>);
</code></pre>
<h2>Delete</h2>
<p><code>delete&lt;T&gt;(url: string, config?: AxiosRequestConfig): Promise&lt;AxiosResponse&lt;T&gt;&gt;</code></p>
<ul>
<li><strong>Description:</strong> Sends an HTTP <code>DELETE</code> request to the specified URL.</li>
</ul>
<p><strong>Parameters:</strong></p>
<ul>
<li>
<p><strong><code>url:</code></strong> The URL to send the DELETE request to.</p>
</li>
<li>
<p><strong><code>config:</code></strong> Optional Axios configuration options.</p>
</li>
<li>
<p><strong>Returns:</strong> A Promise that resolves with an AxiosResponse.</p>
</li>
</ul>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> httpService.<span class="hljs-title function_">delete</span>(<span class="hljs-string">&#x27;https://api.example.com/data/1&#x27;</span>);
</code></pre>
<h2>Head</h2><a id="head" title="Head"></a>
<p><code>head&lt;T&gt;(url: string, config?: AxiosRequestConfig): Promise&lt;AxiosResponse&lt;T&gt;&gt;</code></p>
<ul>
<li><strong>Description:</strong> Sends an HTTP <code>HEAD</code> request to the specified URL to fetch only headers without the response body.</li>
</ul>
<p><strong>Parameters:</strong></p>
<ul>
<li>
<p><strong><code>url:</code></strong> The URL to send the <code>HEAD</code> request to.</p>
</li>
<li>
<p><strong><code>config:</code></strong> Optional Axios configuration options.</p>
</li>
<li>
<p><strong>Returns:</strong> A <code>Promise</code> that resolves with an <code>AxiosResponse</code>.</p>
</li>
</ul>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">httpService</span>.<span class="hljs-title function_">head</span>(<span class="hljs-string">&#x27;https://api.example.com/data&#x27;</span>);
</code></pre>
<h2>Post</h2><a id="post" title="Post"></a>
<p><code>post&lt;T&gt;(url: string, data?: any, config?: AxiosRequestConfig): Promise&lt;AxiosResponse&lt;T&gt;&gt;</code></p>
<ul>
<li><strong>Description:</strong> Sends an HTTP <code>POST</code> request to the specified URL with the given data.</li>
</ul>
<p><strong>Parameters:</strong></p>
<ul>
<li>
<p><strong><code>url:</code></strong> The URL to send the POST request to.</p>
</li>
<li>
<p><strong><code>data:</code></strong> The data to be sent in the request body.</p>
</li>
<li>
<p><strong><code>config:</code></strong> Optional Axios configuration options.</p>
</li>
<li>
<p><strong>Returns:</strong> A <code>Promise</code> that resolves with an <code>AxiosResponse</code>.</p>
</li>
</ul>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> httpService.<span class="hljs-title function_">post</span>(<span class="hljs-string">&#x27;https://api.example.com/data&#x27;</span>, { 
    <span class="hljs-attr">key</span>: <span class="hljs-string">&#x27;value&#x27;</span> 
});
</code></pre>
<h2>Put</h2><a id="put" title="Put"></a>
<p><code>put&lt;T&gt;(url: string, data?: any, config?: AxiosRequestConfig): Promise&lt;AxiosResponse&lt;T&gt;&gt;</code></p>
<ul>
<li><strong>Description:</strong> Sends an HTTP <code>PUT</code> request to the specified URL with the given data.</li>
</ul>
<p><strong>Parameters:</strong></p>
<ul>
<li>
<p><strong><code>url:</code></strong> The URL to send the PUT request to.</p>
</li>
<li>
<p><strong><code>data:</code></strong> The data to be sent in the request body.</p>
</li>
<li>
<p><strong><code>config:</code></strong> Optional Axios configuration options.</p>
</li>
<li>
<p><strong>Returns:</strong> A <code>Promise</code> that resolves with an <code>AxiosResponse</code>.</p>
</li>
</ul>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> httpService.<span class="hljs-title function_">put</span>(<span class="hljs-string">&#x27;https://api.example.com/data/1&#x27;</span>, { 
    <span class="hljs-attr">key</span>: <span class="hljs-string">&#x27;newValue&#x27;</span> 
});
</code></pre>
<h2>Patch</h2><a id="patch" title="Patch"></a>
<p><code>patch&lt;T&gt;(url: string, data?: any, config?: AxiosRequestConfig): Promise&lt;AxiosResponse&lt;T&gt;&gt;</code></p>
<ul>
<li><strong>Description:</strong> Sends an HTTP <code>PATCH</code> request to the specified URL with the given data.</li>
</ul>
<p><strong>Parameters:</strong></p>
<ul>
<li>
<p><strong><code>url:</code></strong> The URL to send the PATCH request to.</p>
</li>
<li>
<p><strong><code>data:</code></strong> The data to be sent in the request body.</p>
</li>
<li>
<p><strong><code>config:</code></strong> Optional Axios configuration options.</p>
</li>
<li>
<p><strong>Returns:</strong> A <code>Promise</code> that resolves with an <code>AxiosResponse</code>.</p>
</li>
</ul>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> httpService.<span class="hljs-title function_">patch</span>(<span class="hljs-string">&#x27;https://api.example.com/data/1&#x27;</span>, { 
    <span class="hljs-attr">key</span>: <span class="hljs-string">&#x27;patchedValue&#x27;</span> 
});
</code></pre>
<h1>Usage</h1><a id="usage" title="Usage"></a>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Service</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@cmmv/core&quot;</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">HttpService</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@cmmv/http&quot;</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Cron</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@cmmv/scheduling&quot;</span>;

<span class="hljs-meta">@Service</span>()
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CryptoPriceService</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> apiUrl = <span class="hljs-string">&quot;https://api.coingecko.com/api/v3/coins/markets&quot;</span>;

    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> <span class="hljs-attr">httpService</span>: <span class="hljs-title class_">HttpService</span>
    </span>){}

    <span class="hljs-meta">@Cron</span>(<span class="hljs-string">&quot;*/1 * * * *&quot;</span>)
    <span class="hljs-keyword">async</span> <span class="hljs-title function_">fetchTopCryptos</span>(<span class="hljs-params"></span>){
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">httpService</span>.<span class="hljs-title function_">get</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">apiUrl</span>, {
                <span class="hljs-attr">params</span>: {
                    <span class="hljs-attr">vs_currency</span>: <span class="hljs-string">&#x27;usd&#x27;</span>,
                    <span class="hljs-attr">order</span>: <span class="hljs-string">&#x27;market_cap_desc&#x27;</span>, 
                    <span class="hljs-attr">page</span>: <span class="hljs-number">1</span>
                }
            });

            <span class="hljs-keyword">if</span> (response.<span class="hljs-property">status</span> === <span class="hljs-number">200</span>) {
                <span class="hljs-keyword">const</span> cryptos = response.<span class="hljs-property">data</span>;
                cryptos.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params"><span class="hljs-attr">crypto</span>: <span class="hljs-built_in">any</span></span>) =&gt;</span> {
                    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`
                        Criptomoeda: <span class="hljs-subst">${crypto.name}</span>, 
                        Preço: $<span class="hljs-subst">${crypto.current_price}</span>
                    `</span>);
                });
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Erro ao obter dados: <span class="hljs-subst">${response.statusText}</span>`</span>);
            }
        } <span class="hljs-keyword">catch</span> (error) {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">&#x27;Erro ao realizar a requisição:&#x27;</span>, error.<span class="hljs-property">message</span>);
        }
    }
}
</code></pre>
<p>The <code>HttpService</code> is a powerful and flexible tool for making HTTP requests within the <code>@cmmv/http</code> framework. It leverages the popular <code>Axios</code> library to handle HTTP operations, providing an easy way to interact with external APIs from your CMMV-based application. Each method corresponds to a standard HTTP request type, and additional configurations can be applied using <code>AxiosRequestConfig</code> to customize behavior like headers, timeouts, and more.</p>
